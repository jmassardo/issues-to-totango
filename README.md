# GitHub Issues to Totango V2

This action takes issues in GitHub that have been labeled either 'task' or 'touchpoint' and turns them into tasks or touchpoints in totango accordingly.

## Limitations and known issues

* See Issues for current bugs (labeled [bug])
* Logic for handling comments on issues has not been implemented

Feature requests are welcome. Please log an issue in this repo for new requests.

## Inputs

These need to all be set up as secrets in the GitHub Repo where the action will be running.

### `ACCOUNT_ID`

**Required** The customer account id.
> Browse to the Account Overview page in Totango > Click All to see all the data > Scroll down to the Account Identifier section. This is also available in the URL.

### `APP_TOKEN`

**Required** This is your API token
> In Totango, click your picture > Edit Profile > Integrations > Copy your API Token Key

### `ACTIVITY_TYPE`

**Required** This is ID of the desired activity type from the Success Flow section.
> Fetch `https://api.totango.com/api/v3/activity-types/` to see the parings. Use the `activity_type_id` value.

Example curl request:

```sh
curl --location --request GET 'https://api.totango.com/api/v3/activity-types/' \
--header 'app-token: TOTANGO_TOKEN'
```

### `TOUCHPOINT_TAGS`

**Required** The GUID of the Touchpoint Reason
Supports `string` or a list of comma-separated `string` values.

> Fetch `https://api.totango.com/api/v3/touchpoint-tags/` to see the parings. Use the `ID` value.

Example curl request:

```sh
curl --location --request GET 'https://api.totango.com/api/v3/touchpoint-tags/' \
--header 'app-token: TOTANGO_TOKEN'
```

### `TOUCHPOINT_TYPE`

**Required** The GUID of the Touchpoint Type.
> Fetch `https://api.totango.com/api/v3/touchpoint-types/` to see the pairings. Use the `ID` value.

Example curl request:

```sh
curl --location --request GET 'https://api.totango.com/api/v3/touchpoint-types/' \
--header 'app-token: TOTANGO_TOKEN'
```

### `TASK_ASSIGNEE`

**Required** When a task is created in Totango, this value will be the assignee for the task. Must be the email associated with Totango sign up (Totango user name). This value is also used as the submitter for a touchpoint.

### `REPO_TOKEN`

**Required** The Auto Generated GitHub Auth token for actions
> Should be defaulted to secrets.GITHUB_TOKEN, it will be generated by actions at runtime

## Outputs

### `touchpoint_id` or `task_id`

The id that Totango returns to you when you create a new touchpoint or task.

## Example usage

See example workflow file at examples/workflow_example.yml

## Building Code

## How To Create a New Task

The tasks API doesn't seem to be documented anywhere. To figure out what is sent to the API, use the Totango test account and Developer Tools while creating/editing a task.

### NodeJs Example

``` javascript
var request = require('request');
var options = {
  'method': 'POST',
  'url': 'https://api.totango.com/api/v3/tasks',
  'headers': {
    'app-token': APP_TOKEN,
    'Content-Type': 'application/x-www-form-urlencoded'
  },
  form: {
    'account_id': ACCOUNT_ID,
    'description': '',
    'assignee': TOTANGO_EMAIL,
    'priority': '2',
    'activity_type_id': ACTIVITY_TYPE,
    'due_date': '2023-1-4',
    'title': 'test',
    'status': 'open'
  }
};
request(options, function (error, response) {
  if (error) throw new Error(error);
  console.log(response.body);
});
```
